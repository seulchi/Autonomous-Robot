## 라인 트레이싱 로봇

### 📝 프로젝트 개요

이 프로젝트는 Arduino를 기반으로 하는 라인 트레이싱 로봇의 소스 코드입니다. 로봇은 라인 스캔 카메라와 스테퍼 모터를 사용하여 바닥의 **가이드 라인(두 줄의 검은색 선)**하며 주행합니다. **비례 제어(Proportional Control)** 방식을 사용하여 선의 위치 변화에 따라 모터의 속도를 조절해 로봇의 방향을 제어합니다.

### ⚙️ 하드웨어 구성

* **마이크로컨트롤러:** Arduino
* **센서:** 라인 스캔 카메라 (`PA0`, `PA1` 핀 사용)
* **모터:** 2개의 스테퍼 모터 (`17`, `21`, `20`, `19`, `18` 핀 사용)

---

### 💻 소프트웨어 구조 및 주요 기능

#### 1. 센서 제어 (`ADC_Get` 함수 및 `loop` 함수)

* `loop` 함수 내의 반복문을 통해 라인 스캔 카메라로부터 **128개의 밝기 데이터**를 읽어옵니다.
* `ADC_Get` 함수는 아날로그-디지털 변환(ADC)을 수행하여 카메라의 밝기 정보를 `camera_data` 배열에 저장합니다.
* `ref` 변수(`200`)는 검은색 선과 흰색 배경을 구분하는 **기준값** 역할을 합니다.
* `loop` 함수는 카메라 데이터를 분석하여 `k1`(왼쪽 라인의 위치)과 `k2`(오른쪽 라인의 위치)를 식별합니다.
    * `k1`: 렌즈 중앙(64)에서 왼쪽으로 이동하며 처음 발견되는 검은 선의 위치.
    * `k2`: 렌즈 중앙(64)에서 오른쪽으로 이동하며 처음 발견되는 검은 선의 위치.

#### 2. 모터 제어 (`ISR(TIMER1_COMPA_vect)` 함수)

* **타이머 인터럽트**를 사용하여 모터를 제어합니다. `timer_init()` 함수는 타이머를 설정하며, `OCR1A` 값(`1650`)을 통해 **모터의 속도를 조절**할 수 있습니다.
* `TIMER1_COMPA_vect` 인터럽트 서비스 루틴(ISR)은 **DDA(Digital Differential Analyzer)** 알고리즘을 사용하여 두 개의 스테퍼 모터를 개별적으로 구동합니다.
* `a`, `b1`, `b2`, `M1`, `M2` 변수를 사용하여 모터의 스텝 속도를 계산합니다.
    * `b1`은 왼쪽 바퀴의 속도, `b2`는 오른쪽 바퀴의 속도입니다.
    * `M1`과 `M2`는 `b1`, `b2` 값에 따라 새로 설정되는 변수입니다.

#### 3. 방향 제어 (`loop` 함수)

* `way` 변수를 사용하여 로봇의 **회전 방향(좌회전: -1, 우회전: 1, 직진: 0)**을 결정합니다.
* `kp` 변수(`100`)는 **비례 제어 상수**로, 로봇의 반응성을 조절하는 데 사용됩니다.
* `k1`과 `k2` 값을 기반으로 `b1`과 `b2`의 값을 조정하여 모터의 속도를 변경합니다.
    * **좌회전(`way == -1`):** `k2` 값이 작아질수록(오른쪽 검은 선이 중앙으로 다가올수록) 왼쪽 모터의 속도는 빨라지고, 오른쪽 모터의 속도는 느려집니다.
    * **우회전(`way == 1`):** `k1` 값이 커질수록(왼쪽 검은 선이 중앙으로 다가올수록) 왼쪽 모터의 속도는 느려지고, 오른쪽 모터의 속도는 빨라집니다.
    * **직진(`way == 0`):** 양쪽 모터의 속도가 `6400`으로 초기화됩니다.

---

### 🔧 설정 및 핀 정의

* **카메라 센서:**
    * `CLK` (클록): `PA0`
    * `SI` (직렬 입력): `PA1`
* **스테퍼 모터:**
    * `EN_PIN` (Enable): `17`
    * `STEP_PIN_1`: `21`
    * `DIR_PIN_1`: `20`
    * `STEP_PIN_2`: `19`
    * `DIR_PIN_2`: `18`
